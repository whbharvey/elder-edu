(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5035],{17620:(e,s,t)=>{Promise.resolve().then(t.bind(t,19098))},19098:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>G});var l=t(95155),n=t(12115),r=t(97605),a=t(20778),d=t(1175),i=t(35125),c=t(44670),o=t(19868),h=t(37974),u=t(12320),x=t(30662),j=t(27212),m=t(21103),A=t(19361),y=t(74947),g=t(85),p=t(95108),v=t(6124),C=t(56020),f=t(94600),b=t(18866),k=t(46002),w=t(13324),S=t(25702),I=t(28562),D=t(79659),N=t(70129),R=t(56170),Y=t(25953),O=t(50274),F=t(46996),L=t(88870);let{Title:M,Text:q,Paragraph:_}=r.A,{Option:z}=a.A,{RangePicker:E}=d.A,{TabPane:B}=i.A,P=[{id:1,name:"太极拳基础班",category:"体育健身",level:"基础班",teacher:"王老师",semester:"2024春季",capacity:30,enrolled:28,classroom:"A101",weekday:"周一",timeSlot:"09:00-11:00"},{id:2,name:"书法提高班",category:"文化艺术",level:"提高班",teacher:"李老师",semester:"2024春季",capacity:25,enrolled:25,classroom:"B203",weekday:"周三",timeSlot:"14:00-16:00"},{id:3,name:"摄影基础班",category:"兴趣爱好",level:"基础班",teacher:"张老师",semester:"2024春季",capacity:20,enrolled:15,classroom:"C105",weekday:"周五",timeSlot:"09:00-11:00"},{id:4,name:"太极拳基础班",category:"体育健身",level:"基础班",teacher:"王老师",semester:"2023秋季",capacity:30,enrolled:30,classroom:"A101",weekday:"周一",timeSlot:"09:00-11:00"},{id:5,name:"书法基础班",category:"文化艺术",level:"基础班",teacher:"李老师",semester:"2023秋季",capacity:25,enrolled:24,classroom:"B203",weekday:"周三",timeSlot:"14:00-16:00"}],T=[{id:1,name:"张三",phone:"13800138001",age:65,semester:"2023秋季",courses:["太极拳基础班","书法基础班"]},{id:2,name:"李四",phone:"13800138002",age:68,semester:"2023秋季",courses:["太极拳基础班"]},{id:3,name:"王五",phone:"13800138003",age:62,semester:"2023秋季",courses:["书法基础班"]},{id:4,name:"赵六",phone:"13800138004",age:70,semester:"2024春季",courses:["太极拳基础班"]},{id:5,name:"孙七",phone:"13800138005",age:58,semester:"2024春季",courses:["摄影基础班"]}],V=[{id:1,name:"2024春季旧生报名",semester:"2024春季",startDate:"2024-01-10",endDate:"2024-01-20",isOldStudent:!0,status:"已结束",courseCount:45,registrationCount:1250,selectedCourses:[1,2,3],oldStudentLists:{1:[1,2],2:[3]}},{id:2,name:"2024春季新生报名",semester:"2024春季",startDate:"2024-01-25",endDate:"2024-02-05",isOldStudent:!1,status:"进行中",courseCount:45,registrationCount:680,selectedCourses:[1,2,3],oldStudentLists:{}},{id:3,name:"2024秋季旧生报名",semester:"2024秋季",startDate:"2024-07-10",endDate:"2024-07-20",isOldStudent:!0,status:"未开始",courseCount:0,registrationCount:0,selectedCourses:[],oldStudentLists:{}}];function G(){var e,s,t;let[r,d]=(0,n.useState)(V),[G,K]=(0,n.useState)(""),[Z,H]=(0,n.useState)(!1),[J,Q]=(0,n.useState)(null),[U,W]=(0,n.useState)(!1),[X,$]=(0,n.useState)([]),[ee,es]=(0,n.useState)({}),[et,el]=(0,n.useState)(""),[en,er]=(0,n.useState)(!1),[ea,ed]=(0,n.useState)(0),[ei]=c.A.useForm(),ec=r.filter(e=>e.name.toLowerCase().includes(G.toLowerCase())||e.semester.toLowerCase().includes(G.toLowerCase())),eo=e=>P.filter(s=>s.semester===e),eh=(e,s)=>T.filter(t=>t.semester===e&&t.courses.includes(s)),eu=e=>{Q(e),ei.setFieldsValue({...e}),$(e.selectedCourses||[]),es(e.oldStudentLists||{}),W(!0)},ex=e=>{d(r.filter(s=>s.id!==e)),o.Ay.success("报名批次删除成功")},ej=e=>{let s={...e,id:Math.max(...r.map(e=>e.id))+1,name:"".concat(e.name," (复制)"),status:"未开始",registrationCount:0};d([...r,s]),o.Ay.success("报名批次复制成功")},em=e=>{$(e);let s={...ee};Object.keys(s).forEach(t=>{e.includes(Number(t))||delete s[Number(t)]}),es(s)},eA=e=>{ed(e),er(!0)},ey=e=>{es({...ee,[ea]:e}),er(!1),o.Ay.success("旧生名单设置成功")},eg=e=>{switch(e){case"进行中":return(0,l.jsx)(h.A,{color:"success",children:"进行中"});case"未开始":return(0,l.jsx)(h.A,{color:"processing",children:"未开始"});case"已结束":return(0,l.jsx)(h.A,{color:"default",children:"已结束"});default:return(0,l.jsx)(h.A,{children:e})}},ep=[{title:"批次名称",dataIndex:"name",key:"name",sorter:(e,s)=>e.name.localeCompare(s.name)},{title:"学期",dataIndex:"semester",key:"semester",filters:[{text:"2024春季",value:"2024春季"},{text:"2024秋季",value:"2024秋季"}],onFilter:(e,s)=>s.semester===e},{title:"报名时间",key:"date",render:(e,s)=>(0,l.jsxs)("span",{children:[s.startDate," 至 ",s.endDate]})},{title:"类型",key:"type",render:(e,s)=>(0,l.jsx)("span",{children:s.isOldStudent?"旧生报名":"新生报名"}),filters:[{text:"旧生报名",value:!0},{text:"新生报名",value:!1}],onFilter:(e,s)=>s.isOldStudent===e},{title:"状态",dataIndex:"status",key:"status",render:e=>eg(e),filters:[{text:"进行中",value:"进行中"},{text:"未开始",value:"未开始"},{text:"已结束",value:"已结束"}],onFilter:(e,s)=>s.status===e},{title:"课程数",dataIndex:"courseCount",key:"courseCount",sorter:(e,s)=>e.courseCount-s.courseCount},{title:"已报名人数",dataIndex:"registrationCount",key:"registrationCount",sorter:(e,s)=>e.registrationCount-s.registrationCount},{title:"操作",key:"action",render:(e,s)=>(0,l.jsxs)(u.A,{size:"small",children:[(0,l.jsx)(x.Ay,{type:"text",icon:(0,l.jsx)(D.A,{}),onClick:()=>eu(s)}),(0,l.jsx)(x.Ay,{type:"text",icon:(0,l.jsx)(N.A,{}),onClick:()=>ej(s)}),(0,l.jsx)(j.A,{title:"删除批次",description:"确定要删除这个报名批次吗？",onConfirm:()=>ex(s.id),okText:"确定",cancelText:"取消",children:(0,l.jsx)(x.Ay,{type:"text",danger:!0,icon:(0,l.jsx)(R.A,{})})})]})}],ev=()=>{let e=ei.getFieldValue("semester");if(!e)return null;let s=eo(e);return(0,l.jsxs)("div",{children:[(0,l.jsx)(c.A.Item,{label:"选择课程",children:(0,l.jsx)(m.A.Group,{value:X,onChange:em,style:{width:"100%"},children:(0,l.jsx)(A.A,{children:s.map(e=>(0,l.jsx)(y.A,{span:24,className:"mb-2",children:(0,l.jsx)(m.A,{value:e.id,children:(0,l.jsx)("div",{className:"flex justify-between items-center w-full",children:(0,l.jsxs)(u.A,{children:[(0,l.jsx)(q,{strong:!0,children:e.name}),(0,l.jsx)(h.A,{color:"blue",children:e.category}),(0,l.jsx)(q,{type:"secondary",children:e.teacher}),(0,l.jsxs)(q,{type:"secondary",children:[e.weekday," ",e.timeSlot]}),(0,l.jsx)(q,{type:"secondary",children:e.classroom}),(0,l.jsx)(g.A,{count:"".concat(e.enrolled,"/").concat(e.capacity),style:{backgroundColor:e.enrolled>=e.capacity?"#ff4d4f":"#52c41a"}})]})})})},e.id))})})}),ei.getFieldValue("isOldStudent")&&X.length>0&&(0,l.jsx)(c.A.Item,{label:"旧生名单设置",children:(0,l.jsx)("div",{className:"space-y-2",children:X.map(e=>{var s;let t=P.find(s=>s.id===e);if(!t)return null;let n=(null===(s=ee[e])||void 0===s?void 0:s.length)||0;return(0,l.jsxs)("div",{className:"flex justify-between items-center p-3 border rounded",children:[(0,l.jsxs)(u.A,{children:[(0,l.jsx)(Y.A,{}),(0,l.jsx)(q,{strong:!0,children:t.name}),(0,l.jsx)(g.A,{count:n,showZero:!0}),(0,l.jsx)(q,{type:"secondary",children:"已设置旧生"})]}),(0,l.jsx)(x.Ay,{type:"link",icon:(0,l.jsx)(O.A,{}),onClick:()=>eA(e),children:"设置旧生名单"})]},e)})})})]})};return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(M,{level:3,children:"报名批次管理"}),(0,l.jsx)(_,{className:"text-gray-500",children:"设置和管理报名开放时间，支持旧生和新生分批报名"})]}),(0,l.jsx)(x.Ay,{type:"primary",icon:(0,l.jsx)(F.A,{}),onClick:()=>{ei.resetFields(),$([]),es({}),el(""),H(!0)},children:"新增批次"})]}),(0,l.jsx)(p.A,{message:"注意",description:"每门课程的具体学员报名情况，请前往【课程管理】页面的点击课程【编辑】进行查看",type:"info",showIcon:!0,style:{marginBottom:"16px"},action:(0,l.jsx)(x.Ay,{size:"small",type:"link",href:"/courses",children:"前往课程管理"})}),(0,l.jsx)(v.A,{children:(0,l.jsxs)(u.A,{direction:"vertical",style:{width:"100%"},children:[(0,l.jsx)(A.A,{gutter:16,children:(0,l.jsx)(y.A,{span:6,children:(0,l.jsx)(C.A,{placeholder:"搜索批次名称或学期",prefix:(0,l.jsx)(L.A,{}),allowClear:!0,value:G,onChange:e=>K(e.target.value)})})}),(0,l.jsx)(f.A,{style:{margin:"12px 0"}}),(0,l.jsx)(b.A,{columns:ep,dataSource:ec,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:e=>"共 ".concat(e," 条记录")}})]})}),(0,l.jsx)(k.A,{title:"新增报名批次",open:Z,onOk:()=>{ei.validateFields().then(e=>{let s={...e,id:Math.max(...r.map(e=>e.id))+1,startDate:e.dateRange&&e.dateRange[0]?e.dateRange[0].format("YYYY-MM-DD"):"",endDate:e.dateRange&&e.dateRange[1]?e.dateRange[1].format("YYYY-MM-DD"):"",status:"未开始",courseCount:X.length,registrationCount:0,selectedCourses:[...X],oldStudentLists:{...ee}};delete s.dateRange,d([...r,s]),H(!1),ei.resetFields(),$([]),es({}),el(""),o.Ay.success("报名批次添加成功")})},onCancel:()=>H(!1),width:900,style:{top:20},children:(0,l.jsxs)(c.A,{form:ei,layout:"vertical",children:[(0,l.jsxs)(A.A,{gutter:16,children:[(0,l.jsx)(y.A,{span:12,children:(0,l.jsx)(c.A.Item,{name:"name",label:"批次名称",rules:[{required:!0,message:"请输入批次名称"}],children:(0,l.jsx)(C.A,{placeholder:"如：2024春季旧生报名"})})}),(0,l.jsx)(y.A,{span:12,children:(0,l.jsx)(c.A.Item,{name:"semester",label:"学期",rules:[{required:!0,message:"请选择学期"}],children:(0,l.jsxs)(a.A,{placeholder:"请选择学期",onChange:()=>{$([]),es({})},children:[(0,l.jsx)(z,{value:"2024春季",children:"2024春季"}),(0,l.jsx)(z,{value:"2024秋季",children:"2024秋季"}),(0,l.jsx)(z,{value:"2025春季",children:"2025春季"})]})})})]}),(0,l.jsx)(A.A,{gutter:16,children:(0,l.jsx)(y.A,{span:24,children:(0,l.jsx)(c.A.Item,{name:"dateRange",label:"报名时间",rules:[{required:!0,message:"请选择报名时间范围"}],children:(0,l.jsx)(E,{style:{width:"100%"}})})})}),(0,l.jsx)(A.A,{gutter:16,children:(0,l.jsx)(y.A,{span:12,children:(0,l.jsx)(c.A.Item,{name:"isOldStudent",label:"报名类型",valuePropName:"checked",children:(0,l.jsx)(w.A,{checkedChildren:"旧生报名",unCheckedChildren:"新生报名",onChange:()=>{es({})}})})})}),ev()]})}),(0,l.jsx)(k.A,{title:"编辑报名批次",open:U,onOk:()=>{ei.validateFields().then(e=>{let s={...J,...e,startDate:e.dateRange&&e.dateRange[0]?e.dateRange[0].format("YYYY-MM-DD"):J.startDate,endDate:e.dateRange&&e.dateRange[1]?e.dateRange[1].format("YYYY-MM-DD"):J.endDate,courseCount:X.length,selectedCourses:[...X],oldStudentLists:{...ee}};delete s.dateRange,d(r.map(e=>e.id===J.id?s:e)),W(!1),ei.resetFields(),$([]),es({}),el(""),o.Ay.success("报名批次更新成功")})},onCancel:()=>W(!1),width:900,style:{top:20},children:(0,l.jsxs)(c.A,{form:ei,layout:"vertical",children:[(0,l.jsxs)(A.A,{gutter:16,children:[(0,l.jsx)(y.A,{span:12,children:(0,l.jsx)(c.A.Item,{name:"name",label:"批次名称",rules:[{required:!0,message:"请输入批次名称"}],children:(0,l.jsx)(C.A,{placeholder:"如：2024春季旧生报名"})})}),(0,l.jsx)(y.A,{span:12,children:(0,l.jsx)(c.A.Item,{name:"semester",label:"学期",rules:[{required:!0,message:"请选择学期"}],children:(0,l.jsxs)(a.A,{placeholder:"请选择学期",onChange:()=>{$([]),es({})},children:[(0,l.jsx)(z,{value:"2024春季",children:"2024春季"}),(0,l.jsx)(z,{value:"2024秋季",children:"2024秋季"}),(0,l.jsx)(z,{value:"2025春季",children:"2025春季"})]})})})]}),(0,l.jsx)(A.A,{gutter:16,children:(0,l.jsx)(y.A,{span:24,children:(0,l.jsx)(c.A.Item,{name:"dateRange",label:"报名时间",rules:[{required:!0,message:"请选择报名时间范围"}],children:(0,l.jsx)(E,{style:{width:"100%"}})})})}),(0,l.jsx)(A.A,{gutter:16,children:(0,l.jsx)(y.A,{span:12,children:(0,l.jsx)(c.A.Item,{name:"isOldStudent",label:"报名类型",valuePropName:"checked",children:(0,l.jsx)(w.A,{checkedChildren:"旧生报名",unCheckedChildren:"新生报名",onChange:()=>{es({})}})})})}),(0,l.jsx)(A.A,{gutter:16,children:(0,l.jsx)(y.A,{span:12,children:(0,l.jsx)(c.A.Item,{name:"status",label:"状态",children:(0,l.jsxs)(a.A,{placeholder:"请选择状态",children:[(0,l.jsx)(z,{value:"进行中",children:"进行中"}),(0,l.jsx)(z,{value:"未开始",children:"未开始"}),(0,l.jsx)(z,{value:"已结束",children:"已结束"})]})})})}),ev()]})}),(0,l.jsxs)(k.A,{title:"设置旧生名单 - ".concat(null===(e=P.find(e=>e.id===ea))||void 0===e?void 0:e.name),open:en,onCancel:()=>er(!1),width:800,footer:null,children:[(0,l.jsxs)(i.A,{defaultActiveKey:"semester",children:[(0,l.jsx)(B,{tab:"按学期选择",children:(0,l.jsxs)(c.A,{layout:"vertical",children:[(0,l.jsx)(c.A.Item,{label:"选择来源学期",children:(0,l.jsxs)(a.A,{placeholder:"请选择学期",value:et,onChange:el,style:{width:"100%"},children:[(0,l.jsx)(z,{value:"2023秋季",children:"2023秋季"}),(0,l.jsx)(z,{value:"2024春季",children:"2024春季"})]})}),et&&(0,l.jsx)(c.A.Item,{label:"选择学员",children:(0,l.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,l.jsx)(m.A.Group,{value:ee[ea]||[],onChange:e=>{es({...ee,[ea]:e})},style:{width:"100%"},children:(0,l.jsx)(S.A,{dataSource:T.filter(e=>e.semester===et),renderItem:e=>(0,l.jsx)(S.A.Item,{children:(0,l.jsx)(m.A,{value:e.id,children:(0,l.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,l.jsxs)(u.A,{children:[(0,l.jsx)(I.A,{children:e.name.substring(0,1)}),(0,l.jsxs)("div",{children:[(0,l.jsx)(q,{strong:!0,children:e.name}),(0,l.jsx)("br",{}),(0,l.jsxs)(q,{type:"secondary",children:[e.phone," | ",e.age,"岁"]})]})]}),(0,l.jsx)("div",{children:(0,l.jsxs)(q,{type:"secondary",children:["课程：",e.courses.join(", ")]})})]})})})})})})})]})},"semester"),(0,l.jsx)(B,{tab:"按课程选择",children:(0,l.jsxs)(c.A,{layout:"vertical",children:[(0,l.jsx)(c.A.Item,{label:"选择来源学期",children:(0,l.jsxs)(a.A,{placeholder:"请选择学期",value:et,onChange:el,style:{width:"100%"},children:[(0,l.jsx)(z,{value:"2023秋季",children:"2023秋季"}),(0,l.jsx)(z,{value:"2024春季",children:"2024春季"})]})}),et&&(0,l.jsx)(c.A.Item,{label:"选择课程",children:(0,l.jsx)(a.A,{placeholder:"请选择课程",style:{width:"100%"},onChange:e=>{let s=eh(et,e).map(e=>e.id);es({...ee,[ea]:s})},children:eo(et).map(e=>(0,l.jsxs)(z,{value:e.name,children:[e.name," (",eh(et,e.name).length,"人)"]},e.id))})}),(null===(s=ee[ea])||void 0===s?void 0:s.length)>0&&(0,l.jsx)(c.A.Item,{label:"已选择的学员",children:(0,l.jsx)(S.A,{dataSource:T.filter(e=>{var s;return null===(s=ee[ea])||void 0===s?void 0:s.includes(e.id)}),renderItem:e=>(0,l.jsx)(S.A.Item,{children:(0,l.jsxs)(u.A,{children:[(0,l.jsx)(I.A,{children:e.name.substring(0,1)}),(0,l.jsxs)("div",{children:[(0,l.jsx)(q,{strong:!0,children:e.name}),(0,l.jsx)("br",{}),(0,l.jsxs)(q,{type:"secondary",children:[e.phone," | ",e.age,"岁"]})]})]})})})})]})},"course")]}),(0,l.jsx)("div",{className:"flex justify-end mt-4 pt-4 border-t",children:(0,l.jsxs)(u.A,{children:[(0,l.jsx)(x.Ay,{onClick:()=>er(!1),children:"取消"}),(0,l.jsxs)(x.Ay,{type:"primary",onClick:()=>ey(ee[ea]||[]),children:["确定 (",(null===(t=ee[ea])||void 0===t?void 0:t.length)||0,"人)"]})]})})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[2239,6034,4405,7641,6467,7062,7845,4069,6002,4670,7238,1175,85,9868,2393,6207,8441,1684,7358],()=>s(17620)),_N_E=e.O()}]);